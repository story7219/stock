# test_gpu_simple.py - Test ëª¨ë“ˆ
# ì—­í• : Test ê´€ë ¨ ê¸°ëŠ¥ ì œê³µ

```python
"""
ğŸš€ GPU ê°€ì† ê°„ë‹¨ í…ŒìŠ¤íŠ¸
=====================================

GPU ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ í™•ì¸ ë° ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
"""

import sys
import time
import numpy as np
import pandas as pd
import torch
import cupy as cp
import cudf


def test_gpu_libraries():
    """GPU ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ í™•ì¸"""
    print("ğŸš€ GPU ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ í™•ì¸")
    print("=" * 50)

    # 1. PyTorch GPU í…ŒìŠ¤íŠ¸
    print("1ï¸âƒ£ PyTorch GPU í…ŒìŠ¤íŠ¸...")
    try:
        print(f"   âœ… PyTorch ë²„ì „: {torch.__version__}")
        print(f"   âœ… CUDA ì‚¬ìš© ê°€ëŠ¥: {torch.cuda.is_available()}")
        if torch.cuda.is_available():
            print(f"   âœ… CUDA ë²„ì „: {torch.version.cuda}")
            print(f"   âœ… GPU ê°œìˆ˜: {torch.cuda.device_count()}")
            print(f"   âœ… í˜„ì¬ GPU: {torch.cuda.get_device_name(0)}")
            memory_allocated = torch.cuda.memory_allocated(0) / 1024**3
            memory_reserved = torch.cuda.memory_reserved(0) / 1024**3
            print(f"   âœ… GPU ë©”ëª¨ë¦¬ ì‚¬ìš©: {memory_allocated:.2f}GB")
            print(f"   âœ… GPU ë©”ëª¨ë¦¬ ì˜ˆì•½: {memory_reserved:.2f}GB")
        else:
            print("   âŒ CUDA ì‚¬ìš© ë¶ˆê°€ëŠ¥")
    except ImportError as e:
        print(f"   âŒ PyTorch ì„¤ì¹˜ ì‹¤íŒ¨: {e}")
        return False

    # 2. cuPy í…ŒìŠ¤íŠ¸
    print("\n2ï¸âƒ£ cuPy í…ŒìŠ¤íŠ¸...")
    try:
        print(f"   âœ… cuPy ë²„ì „: {cp.__version__}")
        x = cp.random.randn(1000, 1000)
        y = cp.random.randn(1000, 1000)
        start_time = time.time()
        z = cp.dot(x, y)
        gpu_time = time.time() - start_time
        print(f"   âœ… GPU í–‰ë ¬ ê³±ì…ˆ: {gpu_time:.4f}ì´ˆ")
        x_cpu = cp.asnumpy(x)
        y_cpu = cp.asnumpy(y)
        start_time = time.time()
        z_cpu = np.dot(x_cpu, y_cpu)
        cpu_time = time.time() - start_time
        print(f"   âœ… CPU í–‰ë ¬ ê³±ì…ˆ: {cpu_time:.4f}ì´ˆ")
        print(f"   âœ… ì†ë„ í–¥ìƒ: {cpu_time / gpu_time:.1f}x")
    except ImportError as e:
        print(f"   âŒ cuPy ì„¤ì¹˜ ì‹¤íŒ¨: {e}")
        return False

    # 3. cuDF í…ŒìŠ¤íŠ¸
    print("\n3ï¸âƒ£ cuDF í…ŒìŠ¤íŠ¸...")
    try:
        print(f"   âœ… cuDF ë²„ì „: {cudf.__version__}")
        df_cpu = pd.DataFrame({
            'A': np.random.randn(10000),
            'B': np.random.randn(10000),
            'C': np.random.randn(10000)
        })
        start_time = time.time()
        df_gpu = cudf.from_pandas(df_cpu)
        gpu_time = time.time() - start_time
        print(f"   âœ… CPU->GPU ë³€í™˜: {gpu_time:.4f}ì´ˆ")
        start_time = time.time()
        result_gpu = df_gpu.mean()
        gpu_op_time = time.time() - start_time
        print(f"   âœ… GPU í‰ê·  ê³„ì‚°: {gpu_op_time:.4f}ì´ˆ")
        start_time = time.time()
        result_cpu = df_cpu.mean()
        cpu_op_time = time.time() - start_time
        print(f"   âœ… CPU í‰ê·  ê³„ì‚°: {cpu_op_time:.4f}ì´ˆ")
        print(f"   âœ… ì†ë„ í–¥ìƒ: {cpu_op_time / gpu_op_time:.1f}x")
    except ImportError as e:
        print(f"   âŒ cuDF ì„¤ì¹˜ ì‹¤íŒ¨: {e}")
        return False

    return True  # í•¨ìˆ˜ ì‹¤í–‰ ê²°ê³¼ ë°˜í™˜


if __name__ == "__main__":
    test_gpu_libraries()
```
