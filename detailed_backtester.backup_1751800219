# detailed_backtester.py - Test ëª¨ë“ˆ
# ì—­í• : Test ê´€ë ¨ ê¸°ëŠ¥ ì œê³µ

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ğŸ”¬ ìƒì„¸ ë°±í…ŒìŠ¤íŠ¸ ì‹œìŠ¤í…œ v2.0
====================================

íŒŒì¼ëª…: detailed_backtester.py
ì—­í• : ê³¼ê±° ë°ì´í„°ë¡œ í˜„ì¬ ì „ëµì˜ ì„±ê³¼ë¥¼ ìƒì„¸íˆ ë¶„ì„ ë° ì‹œê°í™”
- ì¢…í•© ì‹¤ì „ë§¤ë§¤ ë´‡ì˜ ëª¨ë“  ë¡œì§(AI, íˆ¬ìëŒ€ê°€, ë¦¬ìŠ¤í¬ ê´€ë¦¬)ì„ ê·¸ëŒ€ë¡œ ì ìš©í•˜ì—¬ ë°±í…ŒìŠ¤íŠ¸
- ìƒì„¸ ì„±ê³¼ ì§€í‘œ ë¶„ì„ (ìˆ˜ìµë¥ , ìƒ¤í”„, ì†Œë¥´í‹°ë…¸, ì¹¼ë§ˆ, MDD, ìŠ¹ë¥ , ì†ìµë¹„ ë“±)
- ë‹¤ì–‘í•œ ì‹œê°í™” (ìì‚°ê³¡ì„ , ë‚™í­, ì›”ë³„ ìˆ˜ìµë¥  íˆíŠ¸ë§µ ë“±)
- ìµœì¢… ê²°ê³¼ë¥¼ Markdown ë¦¬í¬íŠ¸ë¡œ ì €ì¥
"""

import asyncio
import logging
import json
import time
import sqlite3
import os
import random
from datetime import datetime, timedelta
from typing import Dict, List, Optional, Any, Tuple
from dataclasses import dataclass, field
from enum import Enum
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from pathlib import Path

# í˜„ì¬ í”„ë¡œì íŠ¸ì˜ trading_botì—ì„œ í´ë˜ìŠ¤ ì„í¬íŠ¸
try:
    from comprehensive_trading_bot import (
        MarketType, AssetType, TradeType, InvestmentStyle,
        CapitalAllocation, TradingSymbol, Position,
        INVESTMENT_MASTERS, select_master_by_market
    )
except ImportError:
    print("âŒ comprehensive_trading_bot.pyì—ì„œ í´ë˜ìŠ¤ë¥¼ ì„í¬íŠ¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    # ì„ì‹œìš© ë”ë¯¸ í´ë˜ìŠ¤ (ì‹¤í–‰ì„ ìœ„í•´)
    class MarketType(Enum): DOMESTIC = "domestic"; OVERSEAS = "overseas"
    class AssetType(Enum): STOCK = "stock"; FUTURES = "futures"; OPTIONS = "options"
    class TradeType(Enum): BUY = "buy"; SELL = "sell"; HOLD = "hold"
    class InvestmentStyle(Enum): MID_TERM = "mid_term"; DAY_TRADING = "day_trading"
    @dataclass
    class CapitalAllocation: total_capital: float = 500_000_000
    @dataclass
    class TradingSymbol: symbol: str; name: str; market_type: MarketType; asset_type: AssetType; investment_style: InvestmentStyle; allocation_ratio: float
    @dataclass
    class Position: symbol: str; market_type: MarketType; asset_type: AssetType; quantity: int; avg_price: float; current_price: float; pnl: float; pnl_rate: float; entry_time: datetime; last_update: datetime = field(default_factory=datetime.now); max_pnl_rate: Optional[float] = None
    INVESTMENT_MASTERS = {1: {"name": "Test Master", "strategy": "Test", "market_condition": "bull"}}
    def select_master_by_market(c): return INVESTMENT_MASTERS[1]


# ë¡œê¹… ì„¤ì •
log_dir = Path("logs")
log_dir.mkdir(exist_ok=True)
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler(log_dir / 'detailed_backtester.log', encoding='utf-8'),
        logging.StreamHandler()
    ]
)
logger = logging.getLogger(__name__)

# ... (ë‚˜ë¨¸ì§€ ì½”ë“œ)
```
