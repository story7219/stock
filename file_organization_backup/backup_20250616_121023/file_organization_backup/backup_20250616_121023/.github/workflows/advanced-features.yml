name: ğŸ”¥ ê³ ê¸‰ ê¸°ëŠ¥ ìë™í™”

on:
  schedule:
    - cron: '0 9 * * 1-5'  # í‰ì¼ ì˜¤ì „ 9ì‹œ
  workflow_dispatch:

jobs:
  # ìë™ ë°±í…ŒìŠ¤íŒ… ë° ì„±ê³¼ ë¶„ì„
  automated-analysis:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    
    - name: ğŸ“Š ì£¼ê°„ ì„±ê³¼ ë¶„ì„
      run: |
        python scripts/weekly_performance_analysis.py
        python scripts/strategy_optimization.py
    
    - name: ğŸ“ˆ ë¦¬í¬íŠ¸ ìƒì„±
      run: |
        python scripts/generate_weekly_report.py
    
    - name: ğŸ“§ ë¦¬í¬íŠ¸ ì „ì†¡
      env:
        TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
      run: |
        python scripts/send_weekly_report.py

  # ìë™ ì˜ì¡´ì„± ì—…ë°ì´íŠ¸
  dependency-update:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    
    - name: ğŸ”„ ì˜ì¡´ì„± ì—…ë°ì´íŠ¸ í™•ì¸
      run: |
        pip-audit --desc --output=json > security-audit.json
        python scripts/check_dependency_updates.py
    
    - name: ğŸ”§ ìë™ PR ìƒì„±
      if: success()
      uses: peter-evans/create-pull-request@v5
      with:
        title: "ğŸ”„ ìë™ ì˜ì¡´ì„± ì—…ë°ì´íŠ¸"
        body: "ë³´ì•ˆ ë° ì„±ëŠ¥ ê°œì„ ì„ ìœ„í•œ ì˜ì¡´ì„± ì—…ë°ì´íŠ¸"
        branch: auto-dependency-update 