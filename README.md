# 📊 HTS 스타일 중기투자 퀀트 분석 시스템

증권사 HTS(Home Trading System)처럼 전문적인 인터페이스로 구현된 주식 분석 시스템입니다.

## 🚀 주요 기능

### 📈 HTS 스타일 전문 인터페이스
- **어두운 테마**: 증권사 HTS와 동일한 다크 모드
- **실시간 차트**: matplotlib 기반 전문 차트
- **종목 현황판**: 호가창 스타일의 종목 리스트
- **상세 분석**: 개별 종목 심층 분석

### 🎯 퀀트 분석 기능
- **Value 투자**: PER 기반 가치 평가
- **Quality 투자**: ROE 기반 품질 평가  
- **Momentum 투자**: 수익률 기반 모멘텀 평가
- **Low Volatility**: 변동성 기반 안정성 평가

### 🌍 글로벌 시장 지원
- **한국 시장**: KOSPI/KOSDAQ 종목 분석
- **미국 시장**: NASDAQ/NYSE 종목 분석
- **비교 분석**: 시장간 투자 기회 비교

## 📁 파일 구조

```
📦 test_stock/
├── 📄 mid_term.py          # 핵심 분석 엔진
├── 📄 hts_gui.py           # HTS 스타일 GUI
├── 📄 run_hts.py           # GUI 실행기
├── 📄 create_sample_data.py # 샘플 데이터 생성기
├── 📁 data/
│   └── 📄 stock_data.csv   # 주식 데이터
├── 📁 results/
│   └── 📁 visualizations/ # 생성된 차트들
└── 📄 README.md           # 이 파일
```

## 🛠️ 설치 및 실행

### 1. 필요한 라이브러리 설치
```bash
pip install pandas matplotlib numpy tkinter scikit-learn yfinance seaborn
```

### 2. 샘플 데이터 생성
```bash
python create_sample_data.py
```

### 3. HTS GUI 실행
```bash
python run_hts.py
```

## 📊 HTS 인터페이스 구성

### 🔝 헤더 영역
- **시스템 타이틀**: 중기투자 퀀트 분석 시스템
- **현재 시간**: 실시간 시간 표시
- **분석 시작 버튼**: 🚀 분석 시작

### 📈 메인 화면 (좌측)
#### 종목 현황판
- 순위별 추천 종목 표시
- HTS 호가창 스타일 테이블
- 실시간 색상 구분 (상승/하락)

#### 분석 차트 (2x2 레이아웃)
1. **투자 점수 분포**: 막대 그래프
2. **PER vs ROE**: 산점도 분석
3. **수익률 비교**: 3개월/6개월 비교
4. **시장별 분포**: 파이 차트

### 🔍 상세 정보 (우측)
- **종목 기본 정보**: 시장, 현재가, 시가총액
- **밸류에이션 지표**: PER, ROE, 가치 점수
- **수익률 현황**: 3/6개월 수익률, 변동성
- **종합 평가**: 각 팩터별 점수
- **투자 의견**: 매수/관심/관망 추천

## 🎨 HTS 스타일 디자인

### 색상 체계
- **배경**: `#1e1e1e` (어두운 회색)
- **패널**: `#2d2d2d` (중간 회색)
- **텍스트**: `#ffffff` (흰색)
- **상승/매수**: `#ff4444` (빨간색)
- **하락/매도**: `#4488ff` (파란색)
- **중립**: `#44ff88` (녹색)
- **강조**: `#ffff44` (노란색)

### 폰트
- **기본 폰트**: 맑은 고딕
- **크기**: 헤더 16pt, 본문 10-12pt
- **스타일**: 굵게, 기울임 등 상황별 적용

## 📊 분석 알고리즘

### 종합점수 계산 공식
```
최종점수 = (가치점수 × 25%) + (품질점수 × 30%) + (모멘텀점수 × 30%) + (안정성점수 × 15%)
```

### 각 팩터별 계산
- **가치점수**: (1 - PER정규화) × 100
- **품질점수**: ROE정규화 × 100  
- **모멘텀점수**: ((3M수익률 + 6M수익률) / 2) × 100
- **안정성점수**: (1 - 변동성정규화) × 100

### 필터링 조건
- **최소 시가총액**: 1,000억 이상
- **최대 PER**: 50배 이하
- **최소 ROE**: 5% 이상
- **수익률 범위**: 3M(-20%~), 6M(-30%~)
- **최대 변동성**: 60% 이하

## 🎯 투자 등급

| 점수 범위 | 등급 | 색상 | 의견 |
|-----------|------|------|------|
| 70점 이상 | 🟢 우수 | 빨간색 | 매수 추천 |
| 50-69점 | 🟡 양호 | 노란색 | 관심 종목 |
| 50점 미만 | 🔴 보통 | 파란색 | 관망 |

## 📁 결과 파일

### CSV 파일
- `mid_term_recommend.csv`: 추천 종목 목록
- 한글 헤더, UTF-8 인코딩
- Excel에서 바로 열기 가능

### 차트 파일
- `hts_style_analysis.png`: 메인 분석 차트
- `stock_detail_[종목코드].png`: 개별 종목 상세 차트
- 고해상도 PNG 포맷 (300 DPI)

## 🔧 커스터마이징

### 분석 기준 변경
`mid_term.py`의 `criteria` 딕셔너리에서 수정:
```python
self.criteria = {
    'min_market_cap': 1e11,    # 최소 시가총액
    'max_per': 50,             # 최대 PER
    'min_roe': 5,              # 최소 ROE
    'top_n_per_market': 10     # 시장별 선택 종목 수
}
```

### 색상 테마 변경
`hts_gui.py`의 `colors` 딕셔너리에서 수정:
```python
self.colors = {
    'bg': '#1e1e1e',           # 배경색
    'text': '#ffffff',         # 텍스트색
    'red': '#ff4444',          # 상승색
    'blue': '#4488ff'          # 하락색
}
```

## 🚨 주의사항

1. **투자 참고용**: 실제 투자 결정은 신중히 하세요
2. **데이터 정확성**: 실제 데이터로 교체 필요
3. **리스크 관리**: 분산투자 권장
4. **정기 업데이트**: 데이터 주기적 갱신 필요

## 📞 문의사항

- 기술적 문제: 코드 리뷰 요청
- 기능 개선: 이슈 등록
- 사용법 문의: README 참조

---

**⚠️ 면책조항**: 이 시스템은 교육 및 연구 목적으로 제작되었습니다. 실제 투자에 사용 시 발생하는 손실에 대해 책임지지 않습니다. 