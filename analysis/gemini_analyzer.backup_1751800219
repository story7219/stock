# gemini_analyzer.py - Analysis Engine ëª¨ë“ˆ
# ì—­í• : Analysis Engine ê´€ë ¨ ê¸°ëŠ¥ ì œê³µ

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ðŸ¤– Gemini AI ê¸°ë°˜ íˆ¬ìž ëŒ€ê°€ ì „ëžµ ë¶„ì„ ì‹œìŠ¤í…œ v1.0
===================================================
- ìœŒë¦¬ì—„ ì˜¤ë‹, ì œì‹œ ë¦¬ë²„ëª¨ì–´ ë“± íˆ¬ìž ëŒ€ê°€ ì „ëžµ ì‹œë®¬ë ˆì´ì…˜ ë° AI Top5 ì¶”ì²œ
- Gemini AI API ì—°ë™, ë™ì  í”„ë¡¬í”„íŠ¸, í´ë°± ë¡œì§, ì¢…í•© ë¦¬í¬íŠ¸ ìƒì„±
"""

from datetime import datetime
from dotenv import load_dotenv
from typing import Dict, List, Optional
import google.generativeai as genai
import json
import numpy as np
import os
import pandas as pd
import re
import time
import traceback

# í™˜ê²½ ë³€ìˆ˜ ë¡œë“œ
load_dotenv()

class GeminiAIAnalyzer:
    """Gemini AI ê¸°ë°˜ íˆ¬ìž ë¶„ì„ê¸°"""
    def __init__(self) -> None:
        self.api_key = os.getenv('GEMINI_API_KEY', '')
        self.use_gemini = bool(self.api_key)
        self.portfolio_summary = {}
        if self.api_key:
            genai.configure(api_key=self.api_key)
            model_name = os.getenv('GOOGLE_GEMINI_MODEL',
                                   'gemini-1.5-flash-8b')
            self.model = genai.GenerativeModel(model_name)
        else:
            print("âš ï¸ GEMINI_API_KEYê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤")
            self.model = None


    # ðŸ‘‡ðŸ‘‡ðŸ‘‡ íˆ¬ìžëŒ€ê°€ 20ëª… ì „ëžµ í•¨ìˆ˜ ì¼ê´„ ì¶”ê°€ (1ë²ˆì¤„ë¶€í„° í•œê¸€ì£¼ì„)
    # ê° í•¨ìˆ˜ëŠ” ì‹¬ë³¼, ê°€ê²©, ë³€ë™ì„± ë“± ìƒ˜í”Œ ë°ì´í„°ë§Œìœ¼ë¡œ ì ìˆ˜ ì‚°ì¶œ
    # ì‹¤ì œ íˆ¬ìž ì² í•™ì„ ìµœëŒ€í•œ ë°˜ì˜í•˜ë˜, ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ëžœë¤/ìƒ˜í”Œ ê¸°ì¤€ ì‚¬ìš©

    # 1. ìœŒë¦¬ì—„ ì˜¤ë‹ (ì„±ìž¥+ëª¨ë©˜í…€)
    def _calculate_oneil_score(self, stock: Dict[str, object]) -> float:
        """ìœŒë¦¬ì—„ ì˜¤ë‹ ì „ëžµ ì ìˆ˜ ê³„ì‚° (ì„±ìž¥+ëª¨ë©˜í…€)"""
        score = 0.0
        try:
            symbol = stock.get('symbol', '')
            price = stock.get('current_price', 0)
            change = stock.get('change_rate', 0)
            volume = stock.get('volume', 0)
            if change > 1.5:
                score += 30
            if volume > 1000000:
                score += 20
            if price > 50:
                score += 10
            if symbol in ['AAPL', 'MSFT', 'GOOGL', 'AMZN', 'META']:
                score += 30
        except Exception as e:
            print(f"ì˜¤ë¥˜: {traceback.format_exc()}")  # ì˜ˆì™¸ ì²˜ë¦¬ ê°œì„ 
        return min(score, 100.0)

    # ... (ë‚˜ë¨¸ì§€ í•¨ìˆ˜ë“¤) ...

    # ... (ë‚˜ë¨¸ì§€ ì½”ë“œ) ...
```
