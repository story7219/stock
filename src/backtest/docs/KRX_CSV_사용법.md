# KRX 정보데이터시스템 CSV 사용법

## 📊 KRX CSV 파일 다운로드 방법

### 1. KRX 정보데이터시스템 접속
- **URL**: https://data.krx.co.kr/
- **메뉴**: 상장기업 > 종목정보 > 종목별 시세

### 2. 삼성전자 데이터 검색
1. **종목코드**: 005930 입력
2. **기간 설정**: 1983-06-10 ~ 현재
3. **데이터 형식**: CSV 선택
4. **다운로드** 클릭

### 3. CSV 파일 저장 위치
다운로드한 CSV 파일을 다음 경로 중 하나에 저장하세요:

```
backtest/samsung_krx_data.csv
backtest/005930_krx_data.csv
backtest/samsung_historical_data.csv
backtest/krx_samsung_data.csv
samsung_krx_data.csv
005930_krx_data.csv
```

## 📋 지원하는 CSV 형식

### 형식 1: 한글 컬럼명
```csv
날짜,시가,고가,저가,종가,거래량,거래대금
1983-06-10,1000,1050,980,1020,1000000,1020000000
1983-06-13,1020,1080,1010,1070,1200000,1284000000
```

### 형식 2: 영문 컬럼명
```csv
Date,Open,High,Low,Close,Volume,Amount
1983-06-10,1000,1050,980,1020,1000000,1020000000
1983-06-13,1020,1080,1010,1070,1200000,1284000000
```

### 형식 3: KRX 표준 형식
```csv
일자,시가,고가,저가,종가,거래량,거래대금
1983-06-10,1000,1050,980,1020,1000000,1020000000
1983-06-13,1020,1080,1010,1070,1200000,1284000000
```

## 🔧 자동 처리 기능

### 인코딩 자동 감지
- UTF-8
- CP949 (한국어 Windows)
- EUC-KR (한국어)

### 컬럼명 자동 매핑
- 다양한 KRX CSV 형식을 자동으로 인식
- 필수 컬럼: Date, Open, High, Low, Close, Volume

### 데이터 정제
- 날짜 형식 자동 변환
- 숫자 데이터 타입 변환
- NaN 값 자동 제거
- 날짜순 정렬

## 📈 백테스트 실행

### 1. CSV 파일 준비
```bash
# CSV 파일을 backtest 폴더에 저장
cp samsung_krx_data.csv backtest/
```

### 2. 백테스트 실행
```bash
python backtest/real_data_backtest.py
```

### 3. 결과 확인
- **원본 데이터**: `backtest/krx_processed_data.csv`
- **백테스트 결과**: `backtest/real_backtest_results.csv`
- **차트**: `backtest/real_backtest_chart.png`

## 🎯 장점

### 1. 최대 과거 데이터
- **1983년 상장일부터** 모든 데이터 사용 가능
- 약 42년간의 완전한 주가 데이터

### 2. 정부 공식 데이터
- **KRX 공식 데이터**로 신뢰성 보장
- 조작/가공 없는 원본 데이터

### 3. 자동 처리
- 다양한 CSV 형식 자동 인식
- 인코딩 문제 자동 해결
- 데이터 정제 자동화

## ⚠️ 주의사항

### 1. 파일 크기
- 42년간 데이터는 약 10,000~15,000개 행
- 파일 크기: 약 1-2MB

### 2. 처리 시간
- CSV 파일 읽기: 1-2초
- 전체 백테스트: 5-10초

### 3. 데이터 품질
- 거래정지, 상장폐지 등 특수 상황 포함
- 배당, 액면분할 등 수정주가 반영 여부 확인 필요

## 🔍 문제 해결

### CSV 파일을 찾을 수 없음
```
❌ 사용 가능한 KRX CSV 파일을 찾을 수 없습니다.
💡 KRX 정보데이터시스템에서 삼성전자 데이터를 다운로드하여 다음 경로에 저장하세요:
   - backtest/samsung_krx_data.csv
   - backtest/005930_krx_data.csv
   - samsung_krx_data.csv
```

### 인코딩 오류
- CSV 파일을 메모장으로 열어서 "다른 이름으로 저장" → 인코딩을 UTF-8로 변경

### 컬럼명 오류
- CSV 파일의 첫 번째 행이 헤더인지 확인
- 필수 컬럼(날짜, 시가, 고가, 저가, 종가, 거래량)이 있는지 확인

## 📞 지원

문제가 발생하면 다음을 확인하세요:
1. CSV 파일 경로가 정확한지
2. 파일 형식이 지원되는 형식인지
3. 파일이 손상되지 않았는지
4. 인코딩이 올바른지 