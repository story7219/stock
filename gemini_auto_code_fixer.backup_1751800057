```python
"""
ğŸ¤– Gemini ìë™ ì½”ë“œ ìˆ˜ì • ì—”ì§„ v1.0
====================================

ğŸ“‹ ì‹œìŠ¤í…œ ì—­í• :
- í”„ë¡œì íŠ¸ ë‚´ ëª¨ë“  Python íŒŒì¼(`.py`)ì„ ì¬ê·€ì ìœ¼ë¡œ íƒìƒ‰í•˜ì—¬ êµ¬ë¬¸ ì˜¤ë¥˜(SyntaxError, IndentationError ë“±)ë¥¼ ìë™ìœ¼ë¡œ ê²€ì‚¬í•˜ê³ ,
- ì˜¤ë¥˜ê°€ ë°œê²¬ëœ ê²½ìš°, Gemini AI ëª¨ë¸ì„ í˜¸ì¶œí•˜ì—¬ ì½”ë“œë¥¼ ìë™ìœ¼ë¡œ ìˆ˜ì •í•œ í›„ ì›ë³¸ íŒŒì¼ì„ ë®ì–´ì“°ëŠ” ê°•ë ¥í•œ ìë™í™” ë„êµ¬

ğŸ”§ ì£¼ìš” ê¸°ëŠ¥:
1.  **ìë™ íŒŒì¼ íƒìƒ‰**: ì§€ì •ëœ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ë¶€í„° ëª¨ë“  í•˜ìœ„ ë””ë ‰í† ë¦¬ì˜ Python íŒŒì¼ì„ ìë™ìœ¼ë¡œ íƒìƒ‰
2.  **êµ¬ë¬¸ ì˜¤ë¥˜ ê²€ì‚¬**: `ast.parse`ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ì˜ êµ¬ë¬¸ ìœ íš¨ì„±ì„ ì•ˆì „í•˜ê²Œ í™•ì¸
3.  **AI ê¸°ë°˜ ìë™ ìˆ˜ì •**: ì˜¤ë¥˜ ë©”ì‹œì§€ì™€ ì›ë³¸ ì½”ë“œë¥¼ ë°”íƒ•ìœ¼ë¡œ Gemini AIì—ê²Œ ì½”ë“œ ìˆ˜ì •ì„ ìš”ì²­
4.  **ìˆ˜ì • ì½”ë“œ ê²€ì¦**: AIê°€ ìˆ˜ì •í•œ ì½”ë“œê°€ ë‹¤ì‹œ êµ¬ë¬¸ ì˜¤ë¥˜ë¥¼ í¬í•¨í•˜ê³  ìˆëŠ”ì§€ 2ì°¨ ê²€ì¦ ìˆ˜í–‰
5.  **ê²°ê³¼ ìš”ì•½ ë¦¬í¬íŠ¸**: ì „ì²´ íŒŒì¼ ìˆ˜, ìˆ˜ì • ì„±ê³µ, ì‹¤íŒ¨ ê±´ìˆ˜ë¥¼ ìš”ì•½í•˜ì—¬ ì‘ì—… ê²°ê³¼ë¥¼ ëª…í™•í•˜ê²Œ ì œì‹œ

ğŸ’¡ ì‚¬ìš© ì˜ˆì‹œ:
- `python gemini_auto_code_fixer.py`

âš ï¸ ë§¤ìš° ì¤‘ìš” - ì£¼ì˜ì‚¬í•­:
-   ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” **ì˜¤ë¥˜ê°€ ë°œê²¬ëœ ì›ë³¸ íŒŒì¼ì„ AIê°€ ìˆ˜ì •í•œ ì½”ë“œë¡œ ì¦‰ì‹œ ë®ì–´ì”ë‹ˆë‹¤.**
-   **ì‹¤í–‰ ì „ ë°˜ë“œì‹œ Gitì„ í†µí•´ í”„ë¡œì íŠ¸ ì „ì²´ë¥¼ ì»¤ë°‹í•˜ê±°ë‚˜ ë³„ë„ë¡œ ë°±ì—…í•´ì•¼ í•©ë‹ˆë‹¤.**
-   Gemini API ì‚¬ìš©ì„ ìœ„í•´ `.env` íŒŒì¼ì— `GEMINI_API_KEY` ì„¤ì •ì´ í•„ìˆ˜ì…ë‹ˆë‹¤.
-   API í˜¸ì¶œì— ë”°ë¥¸ ë¹„ìš©ì´ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë©°, `time.sleep(1)`ìœ¼ë¡œ ê¸°ë³¸ì ì¸ API ìš”ì²­ ì†ë„ë¥¼ ì œì–´í•©ë‹ˆë‹¤.
"""

import os
import glob
import ast
import time
from typing import List, Tuple
import sys

# --- í•„ìˆ˜ ëª¨ë“ˆ ì„í¬íŠ¸ ë° ì„¤ì • ---
try:
    from dotenv import load_dotenv
    import google.generativeai as genai
except ImportError:
    print("âŒ í•„ìˆ˜ íŒ¨í‚¤ì§€ê°€ ì„¤ì¹˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
    print("   'pip install google-generativeai python-dotenv' ëª…ë ¹ì–´ë¡œ ì„¤ì¹˜í•´ì£¼ì„¸ìš”.")
    sys.exit(1)

# --- í™˜ê²½ ë³€ìˆ˜ ë° Gemini ì„¤ì • ---
load_dotenv()

GEMINI_API_KEY = os.getenv('GEMINI_API_KEY')
if not GEMINI_API_KEY:
    print('âŒ GEMINI_API_KEYê°€ .env íŒŒì¼ì— ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.')
    sys.exit(1)

genai.configure(api_key=GEMINI_API_KEY)

GEMINI_MODEL = os.getenv('GOOGLE_GEMINI_MODEL', 'gemini-1.5-flash')
GEMINI_TEMPERATURE = float(os.getenv('GEMINI_TEMPERATURE', 0.05))
GEMINI_MAX_TOKENS = int(os.getenv('GEMINI_MAX_TOKENS', 8192))


def get_python_files(root_dir: str) -> List[str]:
    """ì§€ì •ëœ ë””ë ‰í† ë¦¬ì™€ ê·¸ í•˜ìœ„ ë””ë ‰í† ë¦¬ì—ì„œ ëª¨ë“  .py íŒŒì¼ì„ ì°¾ìŠµë‹ˆë‹¤."""
    return glob.glob(os.path.join(root_dir, '**', '*.py'), recursive=True)


def check_syntax(file_path: str) -> Tuple[bool, Exception | None]:
    """íŒŒì¼ì˜ íŒŒì´ì¬ êµ¬ë¬¸ì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•©ë‹ˆë‹¤."""
    try:
        with open(file_path, 'r', encoding='utf-8') as f:
            code = f.read()
        ast.parse(code)
        return True, None
    except (SyntaxError, IndentationError) as e:
        return False, e
    except Exception as e:
        return False, e


def fix_code_with_gemini(code: str, error_message: str) -> str:
    """
    ì˜¤ë¥˜ê°€ ë°œìƒí•œ ì½”ë“œì™€ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ Gemini AIì— ë³´ë‚´ ìˆ˜ì •ì„ ìš”ì²­í•©ë‹ˆë‹¤.
    """
    prompt = f"""
Please fix the syntax error in the following Python code.
Refer to the error message provided.
Return only the complete, corrected Python code, without any explanations, comments, or markdown code blocks.

[Error Message]
{error_message}

[Original Code]
{code}
"""
    model = genai.GenerativeModel(GEMINI_MODEL)
    response = model.generate_content(
        prompt,
        generation_config={
            'temperature': GEMINI_TEMPERATURE,
            'max_output_tokens': GEMINI_MAX_TOKENS
        }
    )
    return response.text.strip()

if __name__ == "__main__":
    root_dir = "C:/Users/User/Desktop/test_stock"  # ìˆ˜ì • í•„ìš”í•œ ë””ë ‰í† ë¦¬ ê²½ë¡œ
    python_files = get_python_files(root_dir)

    for file_path in python_files:
        is_valid, error = check_syntax(file_path)
        if not is_valid:
            with open(file_path, 'r', encoding='utf-8') as f:
                code = f.read()
            fixed_code = fix_code_with_gemini(code, str(error))
            with open(file_path, 'w', encoding='utf-8') as f:
                f.write(fixed_code)
            print(f"íŒŒì¼ {file_path} ìˆ˜ì • ì™„ë£Œ")
        else:
          print(f"íŒŒì¼ {file_path}ëŠ” ì˜¤ë¥˜ê°€ ì—†ìŠµë‹ˆë‹¤.")

```