```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ğŸ“Š AI ê¸°ë°˜ íˆ¬ì ë¶„ì„ ì‹œìŠ¤í…œ - ë¦¬í¬íŠ¸ ìƒì„±ê¸°
ë¶„ì„ ê²°ê³¼ë¥¼ ë‹¤ì–‘í•œ í˜•íƒœë¡œ ì‹œê°í™”í•˜ê³  ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•˜ëŠ” ëª¨ë“ˆ
"""

import os
import json
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import plotly.graph_objects as go
import plotly.express as px
from plotly.subplots import make_subplots
from datetime import datetime, timedelta
from typing import Dict, List, Any, Optional
import base64
from io import BytesIO
import logging
from dataclasses import dataclass
from jinja2 import Template
# pdfkit ì„í¬íŠ¸ ì˜ˆì™¸ ì²˜ë¦¬
try:
    import pdfkit
    PDFKIT_AVAILABLE = True
except ImportError:
    PDFKIT_AVAILABLE = False
from pathlib import Path

# ë¡œê¹… ì„¤ì •
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

@dataclass
class ReportData:
    """ë¦¬í¬íŠ¸ ë°ì´í„° êµ¬ì¡°"""
    top5_selections: List[Dict[str, Any]]
    market_analysis: Dict[str, Any]
    strategy_weights: Dict[str, float]
    timestamp: datetime
    total_analyzed: int
    analysis_duration: float
    confidence_scores: Dict[str, float]

class ReportGenerator:
    """ë¦¬í¬íŠ¸ ìƒì„± í´ë˜ìŠ¤"""
    
    def __init__(self, output_dir: str = "reports"):
        """
        ë¦¬í¬íŠ¸ ìƒì„±ê¸° ì´ˆê¸°í™”
        
        Args:
            output_dir: ë¦¬í¬íŠ¸ ì¶œë ¥ ë””ë ‰í† ë¦¬
        """
        self.output_dir = Path(output_dir)
        self.output_dir.mkdir(exist_ok=True)
        
        # ìŠ¤íƒ€ì¼ ì„¤ì •
        plt.style.use('seaborn-v0_8')
        sns.set_palette("husl")
        
        # í•œê¸€ í°íŠ¸ ì„¤ì •
        plt.rcParams['font.family'] = ['DejaVu Sans', 'Malgun Gothic', 'AppleGothic']
        plt.rcParams['axes.unicode_minus'] = False
        
    def generate_comprehensive_report(
        self, 
        report_data: ReportData,
        formats: List[str] = ["html", "json", "pdf"]
    ) -> Dict[str, Path]:
        """
        ì¢…í•© ë¦¬í¬íŠ¸ ìƒì„±
        
        Args:
            report_data: ë¦¬í¬íŠ¸ ë°ì´í„°
            formats: ìƒì„±í•  ë¦¬í¬íŠ¸ í˜•ì‹ ë¦¬ìŠ¤íŠ¸
            
        Returns:
            ìƒì„±ëœ ë¦¬í¬íŠ¸ íŒŒì¼ ê²½ë¡œë“¤
        """
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        report_files = {}
        
        try:
            # HTML ë¦¬í¬íŠ¸ ìƒì„±
            if "html" in formats:
                html_path = self._generate_html_report(report_data, timestamp)
                report_files["html"] = html_path
                logger.info(f"HTML ë¦¬í¬íŠ¸ ìƒì„± ì™„ë£Œ: {html_path}")
            
            # JSON ë¦¬í¬íŠ¸ ìƒì„±
            if "json" in formats:
                json_path = self._generate_json_report(report_data, timestamp)
                report_files["json"] = json_path
                logger.info(f"JSON ë¦¬í¬íŠ¸ ìƒì„± ì™„ë£Œ: {json_path}")
            
            # PDF ë¦¬í¬íŠ¸ ìƒì„± (pdfkitì´ ìˆì„ ë•Œë§Œ)
            if "pdf" in formats and PDFKIT_AVAILABLE:
                pdf_path = self._generate_pdf_report(report_data, timestamp)
                report_files["pdf"] = pdf_path
                logger.info(f"PDF ë¦¬í¬íŠ¸ ìƒì„± ì™„ë£Œ: {pdf_path}")
            elif "pdf" in formats and not PDFKIT_AVAILABLE:
                logger.warning("pdfkitì´ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•Šì•„ PDF ë¦¬í¬íŠ¸ëŠ” ìƒì„±ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")
                
        except Exception as e:
            logger.error(f"ë¦¬í¬íŠ¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {e}")
            
        return report_files
    # ... (ë‚˜ë¨¸ì§€ ì½”ë“œ ë™ì¼)
```